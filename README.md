# DL. Lab 1. Image classification
Классификация фруктов и овощей

## Команда

Бирюкова Виктория
Сайганова Мария
Кругликова Елена

## Описание проекта

Задача классификации изображений - одна из классических задач компьютерного зрения, которая не теряет своей актуальности, поскольку в различных приложениях и сервисах требуется классифицировать объекты, изображенные на фотографии. Проект представляет собой сервис, решающий эту задачу.

## Описание задачи

Задача представляет собой многоклассовую классификацию изображений с 15 классами.



## Files
| Название | Описание                                                        |
|----------|-----------------------------------------------------------------|
| train.csv| содержит идентификаторы изображений и соответствующие им метки классов              |
| test.csv | содержит идентификаторы изображений без меток классов. Для этих изображений участникам необходимо сформировать предсказания                                  |
| sample_submission.csv | пример файла отправки решения                             |
| train/ | директория с тренировочными изображениями                           |
| test/ | директория с тестовыми изображениями                            |


## Columns

| Колонка | Описание                                                        |
|----------|-----------------------------------------------------------------|
| image_id | Имя файла или относительный путь к изображению              |
| label | Целочисленная метка класса (0–14)                      |


| Индекс | Класс |
|--------|-------|
| 0 | Апельсин |
| 1 | Бананы |
| 2 | Груши |
| 3 | Кабачки |
| 4 | Капуста |
| 5 | Картофель |
| 6 | Киви |
| 7 | Лимон |
| 8 | Лук |
| 9 | Мандарины |
| 10 | Морковь |
| 11 | Огурцы |
| 12 | Томаты |
| 13 | Яблоки зелёные |
| 14 | Яблоки красные |

## Распределение классов

! https://github.com/sunshine-lllssi/--1/blob/фото/Снимок%20экрана%202026-02-26%20в%2021.46.05.png

## Train-аугментации (Albumentations)
- **RandomResizedCrop**: size=224×224, scale=(0.70, 1.0), ratio=(0.75, 1.33)
- **HorizontalFlip**: p=0.5
- **Rotate**: limit=12°, p=0.3
- **OneOf** (p=0.2): GaussNoise(std=0.01–0.05) или GaussianBlur(kernel=3–5)
- **Normalization**: ImageNet stats (mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])

## Validation-трансформы
- Resize до 224×224 + нормализация (без стохастических аугментаций)

## Результаты K-Fold Cross Validation

| Фолд | Архитектура | Эпохи | Validation Accuracy |
|------|-------------|-------|---------------------|
| 1 | efficientnet_b3 | 8 | 0.9293 |
| 2 | efficientnet_b4 | 12 | 0.9344 |
| 3 | resnet50 | 12 | 0.9258 |
| 4 | tf_efficientnet_b4_ns | 10 | 0.9349 |

## Матрица ошибок 

! https://github.com/sunshine-lllssi/--1/blob/фото/Unknown-1.png

## Итоговые метрики

! https://github.com/sunshine-lllssi/--1/blob/фото/Снимок%20экрана%202026-02-26%20в%2021.36.29.png

## TTA
Для каждого изображения при инференсе применялось 15 аугментаций:
1. Оригинал
   
2. Horizontal flip
   
3. Vertical flip

4–6. Повороты на 90, 180, 270

7–9. Flip + повороты

10–11. Scale *0.9 / *1.1 с интерполяцией до 224*224

12–15. Scale + flip

16. CLAHE-аугментация: улучшение контраста в LAB-пространстве (clipLimit=2.0)



## Рассчет f1 на тестовых данных после tta 

! https://github.com/sunshine-lllssi/--1/blob/фото/5262667151015876088.jpg

## Новая матрица ошибок

! https://github.com/sunshine-lllssi/--1/blob/фото/Unknown-2.png


## Результат 
0.95877 на данный момент
